@import '../../abstracts/functions';
@import '../../abstracts/variables';
@import '../../abstracts/mixins';

/**************************** Carousel ****************************/

.responsive-carousel-wrapper .osui-carousel .splide.splide--loop.splide--ltr.splide--draggable.is-active .splide__arrows.splide__arrows--ltr .splide__arrow {
  background: none;
  border: none;
  box-shadow: none;
  bottom: rem(-32) !important;
  top: auto !important;
  cursor: pointer;
  position: absolute;
  transform: none !important;
  height: rem(19);
  width: rem(19);

  svg {
    width: 100%;
    height: 100%;
  }

  &.splide__arrow--prev {
    left: calc(50% - rem(120)) !important;
    right: auto !important;
  }
  
  &.splide__arrow--next {
    right: calc(50% - rem(120)) !important;
    left: auto !important;
  }

  &:hover {
    background: none;
    
    svg path {
      fill: $color-primary;
    }
  }
}

/* Carousel News Banner */
.news-banner-wrapper {
  position: relative;
  height: $banner-height;
  z-index: 1;
  overflow: hidden;

  // Banner content
  .news-banner-content-container {
    position: relative;
    z-index: $z-index-fixed;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    padding-bottom: 60px;

    .news-tab-content {
      &-title {
        font-size: var(--font-size-h1);
        line-height: 1.2;
        color: $color-neutral-0;
        margin-bottom: $space-base;
      }

      &-subtitle {
        font-size: var(--font-size-h6);
        color: $color-neutral-0;
        margin-bottom: $space-l;
      }

      &-button .btn-primary {
        opacity: $opaque;
        transition: opacity 0.2s ease;
        &:hover { opacity: 0.9; }
      }
    }
  }

  // Background handling
  .banner-background-image {
    position: relative;
    height: 100%;
    width: 100%;
    overflow: hidden;
    @include gpu-accelerate;

    &__image {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      z-index: $z-index-dropdown;
      @include gpu-accelerate;
    }

    &::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba($color-neutral-10, $banner-overlay-opacity);
      z-index: $z-index-sticky;
    }

    > * {
      position: relative;
      z-index: $z-index-fixed;
    }
  }
}

// Carousel tabs
.carousel-tabs-container {
  position: absolute;
  bottom: 0;
  left: 20px;
  right: 0;
  height: 60px;
  width: 100%;
  z-index: $z-index-modal;
  box-sizing: border-box;
  overflow: hidden;
  touch-action: pan-x pinch-zoom;
  -webkit-tap-highlight-color: transparent;
  @include gpu-accelerate;

  // Optimized list
  .carousel-tabs-list {
    display: flex;
    height: 100%;
    position: relative;
    width: max-content;
    left: 0;
    transition: left 0.3s ease;
    @include gpu-accelerate;
    
    &.is-dragging {
      transition: none;
      * { pointer-events: none; }
    }
  }

  // Optimized tab items
  .carousel-tabs-item {
    height: $bottom-tab-height;
    display: flex;
    align-items: center;
    justify-content: center;
    color: $color-neutral-0;
    cursor: pointer;
    background-color: rgba($color-neutral-10, 0.4);
    border-top: $border-width solid transparent;
    transition: background-color 0.2s ease;
    box-sizing: border-box;
    padding: 0 $space-s;
    @include gpu-accelerate;

    // States
    &.carousel-tab-selected {
      background-color: rgba($color-neutral-10, 0.7);
      border-top-color: $color-primary;
      border-top-width: $border-width-selected;
    }

    &:not(.carousel-tab-selected):hover {
      background-color: rgba($color-neutral-10, 0.6);
    }

    &:active {
      transform: scale(0.98) translate3d(0, 0, 0);
    }
  }

  // Optimized text
  .carousel-tabs-item-text {
    width: 100%;
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-size: $font-size-base;
    font-weight: 500;
    padding: 0 $space-s;
    user-select: none;
    text-align: center;
  }

  // Draggable states
  &.is-draggable {
    .carousel-tabs-list {
      cursor: grab;
      &.is-dragging { cursor: grabbing; }
    }
  }
}

// Mobile optimizations
@media (max-width: $breakpoint-phone) {
  .news-banner-wrapper {
    height: $banner-height-phone;

    .news-banner-content-container {
      padding-left: calc(var(--os-safe-area-left) + #{$space-base});
      padding-right: calc(var(--os-safe-area-right) + #{$space-base});
      padding-top: calc(var(--os-safe-area-right) - #{$space-base});
      
      .news-tab-content-title {
        font-size: var(--font-size-h2);
      }
      
      .news-tab-content-subtitle {
        font-size: var(--font-size-base);
      }
    }
  }

  .carousel-tabs-container {

    left:0;

    .carousel-tabs-item {
      min-width: 100px;
    }
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
  .carousel-tabs-container * {
    transition: none !important;
  }
}

// Print styles
@media print {
  .carousel-tabs-container {
    display: none;
  }
}

// No JS fallback
.no-js .carousel-tabs-container {
  display: none;
}